<div class="module record-viewer">
    <div class="module-heading">
        <span>Record viewer</span>
        <button class="btn btn-success btn-sm pull-right" (click)="showPatientFind()"><i class="fa fa-search"></i> Find patient</button>
        <button class="btn btn-success btn-sm pull-right" (click)="clearPatient()" [disabled]="patient == null"><i class="fa fa-times-circle"></i> Clear patient</button>
    </div>
    <div class="module-body">

        <div class="container-fluid">
             <div name="noPatientSelectedView" *ngIf="!patient">
                No patient selected
            </div>

            <div name="patientSelectedView" *ngIf="patient">

                <div class="panel panel-default precis">
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-5"><span class="precis-patientname">{{patient.patient?.name | cuiName}}</span></div>
                            <div class="col-sm-3"><span class="precis-label">Born</span> <span class="precis-value">{{patient.patient?.dateOfBirth | cuiDateOfBirth}}</span></div>
                            <div class="col-sm-2"><span class="precis-label">Gender</span> <span class="precis-value">{{patient.patient?.gender | cuiGender}}</span></div>
                            <div class="col-sm-2"><span class="precis-label">NHS No.</span> <span class="precis-value">{{patient.patient?.nhsNumber | cuiNhsNumber}}</span></div>
                        </div>
                    </div>
                </div>

                <ngb-tabset active="activeTab" (tabChange)="beforeTabChange($event)" #recordTabs>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- SUMMARY -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="summary" title="Summary">
                        <template ngbTabContent>
                            <div class="tab-panel">
                                <h4>Summary</h4>
                            </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- CONSULTATIONS -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="consultations" title="Consultations">
                        <template ngbTabContent>
                            <div class="tab-panel">
                                <h4>Consultations</h4>
                            </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- MEDICATION -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="medication" title="Medication">
                        <template ngbTabContent>
                            <div class="tab-panel">
                                <h4>Medication</h4>
                            </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- PROBLEMS -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="problems" title="Problems">
                        <template ngbTabContent>
                            <div class="tab-panel">

                            <div class="container-fluid">
                                <problems title="Active problems" [problems]="patient.getActiveProblems()" placeholder="(No active problems)"></problems>
                                <problems title="Past problems" [problems]="patient.getPastProblems()" placeholder="(No past problems)"></problems>
                            </div>
                        </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- INVESTIGATIONS -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="investigations" title="Investigations">
                        <template ngbTabContent>
                        <div class="tab-panel">

                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-md-8">

                                       <h4>Investigations</h4>

                                        <table class="table table-condensed table-striped table-hover table-selectable clinical-items-table">
                                            <thead>
                                                <th>Date</th>
                                                <th>Term</th>
                                            </thead>
                                            <tbody>
                                                <tr *ngIf="!patient.hasObservations()"><td colspan="2"><i>(no investigations)</i></td></tr>
                                                <tr *ngFor="let observation of patient.observations">
                                                    <td>{{observation.effectiveDate | cuiDate}}</td>
                                                    <td>
                                                        <span class="problem-term-text">{{observation.code | codeReadTerm}}</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- CARE HISTORY -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="careHistory" title="Care History">
                        <template ngbTabContent>
                            <div class="tab-panel">
                                <h4>Care History</h4>
                            </div>
                        </template>
                    </ngb-tab>

                    <!------------------------------------------------------------------------------------------------->
                    <!-- DIARY -->
                    <!------------------------------------------------------------------------------------------------->
                    <ngb-tab id="diary" title="Diary">
                        <template ngbTabContent>
                           <div class="tab-panel">
                            <div class="container-fluid">
                                <diary [diaries]="patient.diary"></diary>
                             </div>
                        </div>
                        </template>
                    </ngb-tab>
                </ngb-tabset>
            </div>
        </div>
    </div>
</div>

