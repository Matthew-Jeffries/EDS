<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>API Test</title>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="styles.css">
		<script src="scripts.js" async defer></script>
	</head>
	<body>

		<main role="main">
			<section class="jumbotron text-center">
				<div class="container">
					<h1 class="jumbotron-heading">Discovery API</h1>
					<b>Important:</b> You must have a valid discovery username and password to obtain a valid authentication token.<br>
					You must have a valid authentication token to call the secure APIs.<br>
					Use <a href="access.html">this form</a> to request access.
				</div>
			</section>

			<div class="container">
				<!-- Authentication -->
				<div class="row">
					<div class="col-md-12">
						<div class="card" id="authentication">
							<div class="card-header">
								<h3>Authentication
									<div class="pull-right">
										<button class="btn btn-sm btn-info" onclick="exampleAuthToken()">Example</button>
										<button class="btn btn-sm btn-success" onclick="getAuthToken()">Run</button>
									</div>
								</h3>
							</div>
							<div class="card-body">
								<div class="card-title">
									<table class="table table-sm table-bordered">
										<tr class="d-flex"><td class="col-2"><b>Method</b></td>  <td class="col-10">POST</td></tr>
										<tr class="d-flex"><td class="col-2"><b>Path</b></td>    <td class="col-10"><b>&lt;auth host&gt;</b>/auth/realms/endeavour/protocol/openid-connect/token</td></tr>
										<tr class="d-flex"><td class="col-2"><b>Header</b></td>  <td class="col-10">Content-Type: application/x-www-form-urlencoded</td></tr>
										<tr class="d-flex"><td class="col-2"><b>Body</b></td>    <td class="col-10">
											client_id  = <b>&lt;client&gt;</b><br>
											username   = <b>&lt;username&gt;</b><br>
											password   = <b>&lt;password&gt;</b><br>
											grant_type = password</td></tr>
									</table>
								</div>
								<hr>
								<div class="card-text">
									<div class="row">
										<div class="col-md-12">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="basic-addon1"><i class="fa fa-fw fa-globe"></i></span>
												</div>
												<input id="authhost" type="text" class="form-control" placeholder="Authorization host" aria-label="Host" aria-describedby="basic-addon1">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="client-addon"><i class="fa fa-fw fa-laptop"></i></span>
												</div>
												<input id="client" type="text" class="form-control" placeholder="Client name" aria-label="Username" aria-describedby="client-addon">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="basic-addon2"><i class="fa fa-fw fa-user"></i></span>
												</div>
												<input id="user" type="text" class="form-control" placeholder="User name" aria-label="Username" aria-describedby="basic-addon2">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="basic-addon3"><i class="fa fa-fw fa-lock"></i></span>
												</div>
												<input id="pass" type="password" class="form-control" placeholder="Password" aria-label="Password" aria-describedby="basic-addon3">
											</div>
										</div>
										<div class="col-md-4"></div>
									</div>
									<hr>
									<div class="row">
										<div class="col-md-12">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="basic-addon4"><i class="fa fa-fw fa-reply"></i></span>
												</div>
												<textarea id="authresponse" type="text" class="form-control" placeholder="Example response: -
{
  'access_token':      <Access token (used for API calls below)>,
  'expires_in':        <token expiry time (seconds)>,
  'refresh_expires':   <refresh expiry time (seconds)>,
  'refresh_token':     <refresh token>,
  'token_type':        'bearer',
  'id_token':          <id_token>,
  'not-before-policy': <timestamp the access token is valid from>,
  'session_state':     <session state id>
}
" aria-label="Response" aria-describedby="basic-addon4" rows="10" style="font-family: monospace; font-size: 10pt"></textarea>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<br>
				<!-- Get patient flag -->
				<div class="row">
					<div class="col-md-12">
						<div class="card" id="patientFlag">
							<div class="card-header">
								<h3>Get flag for patient
									<div class="pull-right">
										<button class="btn btn-sm btn-info" onclick="exampleFlag()">Example</button>
										<button class="btn btn-sm btn-success" onclick="getFlag()">Run</button>
									</div>
								</h3>
							</div>
							<div class="card-body">
								<div class="card-title">
									<table class="table table-sm table-bordered">
										<tr class="d-flex"><td class="col-2"><b>Method</b></td>            <td class="col-10">GET</td></tr>
										<tr class="d-flex"><td class="col-2"><b>Path</b></td>              <td class="col-10"><b>&lt;api host&gt;</b>/api/subscriber/flag
										<tr class="d-flex"><td class="col-2"><b>Headers</b></td>           <td class="col-10">
											Authorization: Bearer <b>&lt;Token&gt;</b><small class="pull-right">(for client eds-subscriber)</small><br>
											OdsCode: <b>&lt;ODS Code&gt;</b>
										<tr class="d-flex"><td class="col-2"><b>Query parameters</b></td>  <td class="col-10">
											code=<b>&lt;Flag code&gt;</b><br>
											subject=<b>&lt;NHS number&gt;</b>
										</td></tr>
									</table>
								</div>
								<hr>
								<div class="card-text">
									<div class="row">
										<div class="col-md-12">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="apihost4-addon"><i class="fa fa-fw fa-globe"></i></span>
												</div>
												<input id="apihost4" type="text" class="form-control" placeholder="API host" aria-label="Host" aria-describedby="apihost4-addon">
											</div>
										</div>
										<div class="col-md-12">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="token4-addon"><i class="fa fa-fw fa-key"></i></span>
												</div>
												<input id="token4" type="text" class="form-control" placeholder="Token" aria-label="Token" aria-describedby="token4-addon">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="requester-addon"><i class="fa fa-fw fa-hospital-o"></i></span>
												</div>
												<input id="requester" type="text" class="form-control" placeholder="ODS Code" aria-label="Host" aria-describedby="requester-addon">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="flag-addon"><i class="fa fa-fw fa-flag-o"></i></span>
												</div>
												<input id="flag" type="text" class="form-control" placeholder="Flag code" aria-label="Host" aria-describedby="flag-addon">
											</div>
										</div>
										<div class="col-md-4">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="nhs2-addon"><i class="fa fa-fw fa-id-card-o"></i></span>
												</div>
												<input id="nhs2" type="text" class="form-control" placeholder="NHS Number" aria-label="Host" aria-describedby="nhs2-addon">
											</div>
										</div>
									</div>
									<hr>
									<div class="row">
										<div class="col-md-12">
											<div class="input-group mb-3">
												<div class="input-group-prepend">
													<span class="input-group-text" id="flagresponse-addon"><i class="fa fa-fw fa-reply"></i></span>
												</div>
												<textarea id="flagresponse" type="text" class="form-control" placeholder="Example response: -
{
  'resourceType': 'Parameters',
  'parameter': [
    { 'name': 'code', 'valueString': <Flag code> },
    { 'name': 'subject', 'valueString': <NHS Number> },
    { 'name': 'return', 'resource': {
        'resourceType': 'Flag',
        'status': 'active',
        'code': {
          'coding': [
            { 'code': '289999999105', 'display': 'Potentially frail'}
          ],
          'text': 'Potentially frail'
        }
      }
    }
  ]
}
" aria-label="Response" aria-describedby="flagresponse-addon" rows="10" style="font-family: monospace; font-size: 10pt"></textarea>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
        <br>
        <!-- UPRN API -->
        <div class="row">
          <div class="col-md-12">
            <div class="card" id="uprn">
              <div class="card-header">
                <h3>UPRN lookup
                  <div class="pull-right">
                    <button class="btn btn-sm btn-info" onclick="exampleUPRN()">Example</button>
                    <button class="btn btn-sm btn-success" onclick="getUPRN()">Run</button>
                  </div>
                </h3>
              </div>
              <div class="card-body">
                <div class="card-title">
                  <table class="table table-sm table-bordered">
                    <tr class="d-flex"><td class="col-2"><b>Method</b></td>            <td class="col-10">GET</td></tr>
                    <tr class="d-flex"><td class="col-2"><b>Path</b></td>              <td class="col-10"><b>&lt;api host&gt;</b>/api/getinfo
                    <tr class="d-flex"><td class="col-2"><b>Headers</b></td>           <td class="col-10">
                      Authorization: Bearer <b>&lt;Token&gt;</b><small class="pull-right">(for client uprn)</small>
                    <tr class="d-flex"><td class="col-2"><b>Query parameters</b></td>  <td class="col-10">
                      adrec=<b>&lt;Address string, ending with Post Code&gt;</b><br>
                      qpost=<b>&lt;List of Post Code areas&gt;</b> (optional)<br>
                      orgpost=<b>&lt;Local organisation post code&gt;</b> (optional)<br>
                      country=<b>&lt;England|Wales&gt;</b> (optional)<br>
                      summary=<b>&lt;0|1&gt;</b> (optional)
                    </td></tr>
                  </table>
                </div>
                <hr>
                <div class="card-text">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="apihost5-addon"><i class="fa fa-fw fa-globe"></i></span>
                        </div>
                        <input id="apihost5" type="text" class="form-control" placeholder="API host" aria-label="Host" aria-describedby="apihost5-addon">
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="token5-addon"><i class="fa fa-fw fa-key"></i></span>
                        </div>
                        <input id="token5" type="text" class="form-control" placeholder="Token" aria-label="Token" aria-describedby="token5-addon">
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-address-addon"><i class="fa fa-fw fa-map-marker"></i></span>
                        </div>
                        <input id="uprn-address" type="text" class="form-control" placeholder="Address (ending with Post Code)" aria-label="Host" aria-describedby="uprn-address-addon">
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-qpost-addon"><i class="fa fa-fw fa-map-o"></i></span>
                        </div>
                        <input id="uprn-qpost" type="text" class="form-control" placeholder="Post Code areas (comma separated)" aria-label="Host" aria-describedby="uprn-qpost-addon">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-org-addon"><i class="fa fa-fw fa-hospital-o"></i></span>
                        </div>
                        <input id="uprn-org" type="text" class="form-control" placeholder="Organisation Post Code" aria-label="Host" aria-describedby="uprn-org-addon">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-country-addon"><i class="fa fa-fw fa-flag-o"></i></span>
                        </div>
                        <input id="uprn-country" type="text" class="form-control" placeholder="Country (England|Wales)" aria-label="Host" aria-describedby="uprn-country-addon">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-summary-addon"><i class="fa fa-fw fa-file-text-o"></i></span>
                        </div>
                        <input id="uprn-summary" type="text" class="form-control" placeholder="Summary (0 or 1)" aria-label="Host" aria-describedby="uprn-summary-addon">
                      </div>
                    </div>
                  </div>
                  <hr>
                  <div class="row">
                    <div class="col-md-12">
                      <div class="input-group mb-3">
                        <div class="input-group-prepend">
                          <span class="input-group-text" id="uprn-response-addon"><i class="fa fa-fw fa-reply"></i></span>
                        </div>
                        <textarea id="uprn-response" type="text" class="form-control" placeholder="Example response: -
{
   'Address_format': 'good',
   'Postcode_quality': 'good',
   'Matched': true,
   'UPRN': '100023336956',
   'Qualifier': 'Equivalent',
   'Classification': 'RD04',
   'Algorithm': '3100-match60',
   'ABPAddress': {
     'Number': '10',
     'Street': 'Downing Street',
     'Town': 'London',
     'Postcode': 'SW1A 2AA',
     'Organisaton': 'prime minister & first lord of the treasury'
   },
   'Match_pattern': {
     'Postcode': 'equivalent',
     'Street': 'equivalent',
     'Number': 'equivalent',
     'Building': 'equivalent',
     'Flat': 'equivalent'
   }
}
" aria-label="Response" aria-describedby="uprn-response-addon" rows="10" style="font-family: monospace; font-size: 10pt"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <br>
			</div>
		</main>
	</body>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
</html>
